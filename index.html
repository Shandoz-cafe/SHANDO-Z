<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flappy Bird - Super Mirip!</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            display: flex; flex-direction: column; 
            justify-content: center; align-items: center; 
            min-height: 100vh; 
            background: linear-gradient(135deg, #70c5ce 0%, #459ba8 100%);
            font-family: 'Press Start 2P', monospace;
            overflow: hidden;
        }
        canvas { 
            border: 4px solid #000;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
            background: #70c5ce;
        }
        #ui {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            color: #fff;
            text-shadow: 2px 2px 0px #000;
            z-index: 100;
        }
        #medal {
            font-size: 12px;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div id="ui">
        <div id="score">0</div>
        <div id="medal"></div>
    </div>
    <canvas id="game" width="288" height="512"></canvas>

    <script>
        const canvas = document.getElementById('game');
        const ctx = canvas.getContext('2d');
        ctx.imageSmoothingEnabled = false;
        ctx.fillStyle = '#70c5ce';
        ctx.fillRect(0, 0, 288, 512);

        // Game state
        let gameState = 'start'; // start, playing, gameover
        let score = 0;
        let bestScore = localStorage.getItem('flappyBest') || 0;
        
        let bird = {
            x: 60, y: 150, vy: 0, 
            width: 34, height: 24,
            wingFlap: 0, frame: 0,
            gravity: 0.3, jump: -6.5
        };
        
        let pipes = [];
        let pipeTimer = 0;
        let scrollX = 0;

        // Bird sprites (pixel perfect)
        const birdFrames = [
            // Frame 0: middle
            [[0,0,1,1,1,1,0,0,0,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,0],
             [0,1,1,1,1,1,0,0,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,0],
             [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
             [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
             [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
             [0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0],
             [0,0,1,1,1,1,0,0,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,0],
             [0,0,0,1,1,1,0,0,0,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,0]],
            
            // Frame 1: up
            [[0,0,0,1,1,1,0,0,0,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,0],
             [0,0,1,1,1,1,0,0,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,0],
             [0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
             [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
             [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
             [0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0],
             [0,0,1,1,1,1,0,0,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,0],
             [0,0,0,1,1,1,0,0,0,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,0]]
        ];

        function drawBird() {
            const frame = Math.floor(bird.frame) % 2;
            ctx.fillStyle = '#fab005';
            ctx.fillRect(bird.x, bird.y, bird.width, bird.height);
            
            ctx.fillStyle = '#fc0';
            ctx.fillRect(bird.x+2, bird.y+2, bird.width-4, bird.height-4);
            
            ctx.fillStyle = '#ffeb54';
            ctx.fillRect(bird.x+4, bird.y+4, bird.width-8, bird.height-8);
            
            // Draw beak
            ctx.fillStyle = '#ff8c00';
            ctx.fillRect(bird.x+26, bird.y+10, 8, 4);
            ctx.fillRect(bird.x+30, bird.y+8, 4, 8);
            
            // Eye
            ctx.fillStyle = 'white';
            ctx.fillRect(bird.x+18, bird.y+4, 8, 8);
            ctx.fillStyle = 'black';
            ctx.fillRect(bird.x+22, bird.y+6, 4, 4);
            
            // Wing animation
            bird.wingFlap += 0.3;
            const wingY = Math.sin(bird.wingFlap) * 2;
            ctx.fillStyle = '#ff8c00';
            ctx.fillRect(bird.x+4, bird.y+12+wingY, 16, 6);
        }

        function drawPipe(x, topHeight, gapY, gapHeight) {
            const pipeWidth = 52;
            const capHeight = 30;
            
            // Top pipe
            ctx.fillStyle = '#569454';
            ctx.fillRect(x, 0, pipeWidth, topHeight);
            ctx.fillStyle = '#7ac483';
            ctx.fillRect(x-4, topHeight-capHeight, pipeWidth+8, capHeight);
            
            // Bottom pipe  
            ctx.fillStyle = '#569454';
            ctx.fillRect(x, gapY+gapHeight, pipeWidth, 512-gapY-gapHeight);
            ctx.fillStyle = '#7ac483';
            ctx.fillRect(x-4, gapY+gapHeight, pipeWidth+8, capHeight);
            
            // Pipe highlights
            ctx.fillStyle = '#8ad38f';
            ctx.fillRect(x+2, 0, 4, topHeight);
            ctx.fillRect(x+2, gapY+gapHeight, 4, 512-gapY-gapHeight);
        }

        function drawBase() {
            scrollX -= 2;
            if (scrollX <= -336) scrollX = 0;
            
            ctx.fillStyle = '#ded895';
            ctx.fillRect(0, 400, 288, 112);
            ctx.fillStyle = '#c8c868';
            ctx.fillRect(scrollX, 400, 336, 112);
            ctx.fillRect(scrollX+336, 400, 336, 112);
        }

        function drawUI() {
            document.getElementById('score').textContent = score;
            
            if (score > bestScore) {
                bestScore = score;
                localStorage.setItem('flappyBest', bestScore);
            }
            
            const medals = ['ðŸ¥‰', 'ðŸ¥ˆ', 'ðŸ¥‡'];
            document.getElementById('medal').textContent = 
                score >= 10 ? medals[Math.min(Math.floor(score/10)-1, 2)] : '';
        }

        function collision(bird, pipe) {
            return bird.x < pipe.x + 52 &&
                   bird.x + 34 > pipe.x &&
                   (bird.y < pipe.topHeight || 
                    bird.y + 24 > pipe.gapY + 150);
        }

        function update() {
            if (gameState !== 'playing') return;
            
            // Bird physics
            bird.vy += bird.gravity;
            bird.y += bird.vy;
            bird.frame += 0.2;
            
            // Ground/ceiling collision
            if (bird.y + 24 > 400 || bird.y < 0) {
                gameState = 'gameover';
            }
            
            // Update pipes
            pipes.forEach((pipe, i) => {
                pipe.x -= 2;
                
                if (!pipe.scored && pipe.x + 52 < bird.x) {
                    score++;
                    pipe.scored = true;
                }
                
                if (collision(bird, pipe)) {
                    gameState = 'gameover';
                }
                
                if (pipe.x + 52 < 0) {
                    pipes.splice(i, 1);
                }
            });
            
            // Spawn pipes
            pipeTimer++;
            if (pipeTimer > 90) {
                const gap = 150;
                const topHeight = 50 + Math.random() * 200;
                pipes.push({
                    x: 288, 
                    topHeight,
                    gapY: topHeight,
                    scored: false
                });
                pipeTimer = 0;
            }
        }

        function drawStartScreen() {
            ctx.fillStyle = 'rgba(0,0,0,0.5)';
            ctx.fillRect(0, 0, 288, 512);
            
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 40px Press Start 2P';
            ctx.textAlign = 'center';
            ctx.fillText('FLAPPY BIRD', 144, 180);
            
            ctx.font = '20px Press Start 2P';
            ctx.fillText('Klik atau Spasi', 144, 250);
            ctx.fillText('untuk terbang!', 144, 280);
            
            ctx.font = '16px Press Start 2P';
            ctx.fillText(`Best: ${bestScore}`, 144, 350);
        }

        function drawGameOver() {
            ctx.fillStyle = 'rgba(0,0,0,0.8)';
            ctx.fillRect(0, 0, 288, 512);
            
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 30px Press Start 2P';
            ctx.textAlign = 'center';
            ctx.fillText('GAME OVER', 144, 200);
            
            ctx.font = '24px Press Start 2P';
            ctx.fillText(`Skor: ${score}`, 144, 250);
            ctx.fillText(`Best: ${bestScore}`, 144, 290);
            
            ctx.font = '16px Press Start 2P';
            ctx.fillText('Refresh untuk main lagi', 144, 350);
        }

        function gameLoop() {
            ctx.fillStyle = '#70c5ce';
            ctx.fillRect(0, 0, 288, 512);
            
            drawBase();
            drawBird();
            drawPipes();
            drawUI();
            
            update();
            
            if (gameState === 'start') {
                drawStartScreen();
            } else if (gameState === 'gameover') {
                drawGameOver();
            } else {
                requestAnimationFrame(gameLoop);
            }
        }

        function startGame() {
            gameState = 'playing';
            bird.y = 150;
            bird.vy = 0;
            pipes = [];
            pipeTimer = 0;
            score = 0;
        }

        // Input
        function flap() {
            if (gameState === 'start') {
                startGame();
            } else if (gameState === 'playing') {
                bird.vy = bird.jump;
                // Wing flap sound effect (visual)
                bird.frame = 0;
            }
        }

        document.addEventListener('keydown', e => {
            if (e.code === 'Space') {
                e.preventDefault();
                flap();
            }
        });
        
        canvas.addEventListener('click', flap);
        canvas.addEventListener('touchstart', e => {
            e.preventDefault();
            flap();
        });

        gameLoop();
    </script>
</body>
</html>
