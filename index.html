<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flappy Bird - FULL FEATURES!</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            display: flex; flex-direction: column; 
            justify-content: center; align-items: center; 
            min-height: 100vh; 
            background: linear-gradient(135deg, #87CEEB 0%, #98D8C8 50%, #F0E68C 100%);
            font-family: Arial, sans-serif;
            overflow: hidden;
        }
        canvas { 
            border: 4px solid #000;
            background: #87CEEB;
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
        }
        #ui {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: #fff;
            font-size: 24px;
            font-weight: bold;
            text-shadow: 3px 3px 0px #000;
            z-index: 100;
        }
        #medal {
            font-size: 20px;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div id="ui">
        <div>SKOR: <span id="score">0</span></div>
        <div>BEST: <span id="bestScore">0</span></div>
        <div id="medal"></div>
    </div>
    <canvas id="game" width="400" height="600"></canvas>

    <script>
        const canvas = document.getElementById('game');
        const ctx = canvas.getContext('2d');
        const scoreEl = document.getElementById('score');
        const bestScoreEl = document.getElementById('bestScore');
        const medalEl = document.getElementById('medal');

        // Game state
        let gameState = 'start';
        let score = 0;
        let bestScore = localStorage.getItem('flappyBest') || 0;
        bestScoreEl.textContent = bestScore;

        // Bird
        const bird = {
            x: 80, y: 300, vy: 0, width: 34, height: 24,
            gravity: 0.4, jump: -9, rotation: 0, flap: 0
        };

        // Game objects
        let pipes = [];
        let particles = [];
        let pipeTimer = 0;
        let frame = 0;
        let speed = 2;

        // Clouds
        const clouds = [
            {x: 50, y: 80, size: 60, speed: 0.3, alpha: 0.8},
            {x: 200, y: 120, size: 80, speed: 0.2, alpha: 0.7},
            {x: 350, y: 60, size: 70, speed: 0.25, alpha: 0.9},
            {x: 100, y: 200, size: 50, speed: 0.35, alpha: 0.6},
            {x: 280, y: 140, size: 90, speed: 0.15, alpha: 0.85}
        ];

        // âœ¨ TAMBAHAN FITUR BARU âœ¨
        function drawSun() {
            const sunX = 350 + Math.sin(frame * 0.01) * 10;
            const sunY = 80 + Math.cos(frame * 0.01) * 5;
            
            // Glow effect
            const gradient = ctx.createRadialGradient(sunX, sunY, 0, sunX, sunY, 40);
            gradient.addColorStop(0, 'rgba(255,255,0,0.8)');
            gradient.addColorStop(0.6, 'rgba(255,200,0,0.4)');
            gradient.addColorStop(1, 'rgba(255,150,0,0)');
            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.arc(sunX, sunY, 40, 0, Math.PI*2);
            ctx.fill();
            
            // Sun core
            ctx.fillStyle = '#FFD700';
            ctx.beginPath();
            ctx.arc(sunX, sunY, 20, 0, Math.PI*2);
            ctx.fill();
        }

        function drawClouds() {
            clouds.forEach(cloud => {
                cloud.x += cloud.speed;
                if (cloud.x > 450) cloud.x = -cloud.size;
                
                ctx.save();
                ctx.globalAlpha = cloud.alpha;
                
                // Cloud puffs
                ctx.fillStyle = 'rgba(255,255,255,0.95)';
                ctx.beginPath();
                ctx.arc(cloud.x, cloud.y, cloud.size*0.3, 0, Math.PI*2);
                ctx.arc(cloud.x+cloud.size*0.3, cloud.y, cloud.size*0.4, 0, Math.PI*2);
                ctx.arc(cloud.x+cloud.size*0.6, cloud.y, cloud.size*0.35, 0, Math.PI*2);
                ctx.arc(cloud.x+cloud.size*0.2, cloud.y-cloud.size*0.1, cloud.size*0.25, 0, Math.PI*2);
                ctx.fill();
                ctx.restore();
            });
        }

        function createParticles(x, y) {
            for(let i = 0; i < 8; i++) {
                particles.push({
                    x: x, y: y,
                    vx: (Math.random()-0.5)*6,
                    vy: (Math.random()-0.5)*6,
                    life: 30,
                    maxLife: 30,
                    size: Math.random()*4 + 2
                });
            }
        }

        function updateParticles() {
            for(let i = particles.length-1; i >= 0; i--) {
                const p = particles[i];
                p.x += p.vx;
                p.y += p.vy;
                p.life--;
                p.vy += 0.1;
                
                if (p.life <= 0) {
                    particles.splice(i, 1);
                }
            }
        }

        function drawParticles() {
            particles.forEach(p => {
                ctx.save();
                ctx.globalAlpha = p.life / p.maxLife;
                ctx.fillStyle = '#ffcc00';
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.size, 0, Math.PI*2);
                ctx.fill();
                ctx.restore();
            });
        }

        function drawBird() {
            ctx.save();
            ctx.translate(bird.x + bird.width/2, bird.y + bird.height/2);
            ctx.rotate(bird.rotation);
            
            // Body
            ctx.fillStyle = '#ffcc00';
            ctx.fillRect(-bird.width/2, -bird.height/2, bird.width, bird.height);
            ctx.fillStyle = '#ffeb54';
            ctx.fillRect(-bird.width/2+3, -bird.height/2+3, bird.width-6, bird.height-6);
            
            // Eye
            ctx.fillStyle = 'white';
            ctx.beginPath();
            ctx.arc(11, -4, 6, 0, Math.PI*2);
            ctx.fill();
            ctx.fillStyle = 'black';
            ctx.beginPath();
            ctx.arc(13, -5, 3, 0, Math.PI*2);
            ctx.fill();
            
            // Beak
            ctx.fillStyle = '#ff8c00';
            ctx.beginPath();
            ctx.moveTo(16, 0);
            ctx.lineTo(26, 2);
            ctx.lineTo(16, 4);
            ctx.fill();
            
            // Wing flap
            bird.flap += 0.4;
            const wingY = Math.sin(bird.flap) * 3;
            ctx.fillStyle = '#ff8c00';
            ctx.fillRect(-8, 4+wingY, 18, 6);
            
            ctx.restore();
        }

        function drawPipes() {
            pipes.forEach(pipe => {
                const width = 52;
                const cap = 28;
                
                // Top pipe
                ctx.fillStyle = '#569454';
                ctx.fillRect(pipe.x, 0, width, pipe.topHeight);
                ctx.fillStyle = '#7ac483';
                ctx.fillRect(pipe.x-3, pipe.topHeight-cap, width+6, cap);
                ctx.fillStyle = '#8ad38f';
                ctx.fillRect(pipe.x+3, 0, 3, pipe.topHeight);
                
                // Bottom pipe
                ctx.fillStyle = '#569454';
                ctx.fillRect(pipe.x, pipe.bottomY, width, 540-pipe.bottomY);
                ctx.fillStyle = '#7ac483';
                ctx.fillRect(pipe.x-3, pipe.bottomY, width+6, cap);
                ctx.fillStyle = '#8ad38f';
                ctx.fillRect(pipe.x+3, pipe.bottomY, 3, 540-pipe.bottomY);
            });
        }

        function drawGround() {
            const groundY = 500;
            ctx.fillStyle = '#ded895';
            ctx.fillRect(0, groundY, 400, 100);
            
            ctx.save();
            ctx.translate(frame * -speed * 0.8, 0);
            ctx.fillStyle = '#c8c868';
            for(let i = 0; i < 500; i += 25) {
                ctx.beginPath();
                ctx.moveTo(i, groundY);
                ctx.lineTo(i+12, groundY-20);
                ctx.lineTo(i+25, groundY);
                ctx.fill();
            }
            ctx.restore();
        }

        function drawStartScreen() {
            ctx.fillStyle = 'rgba(0,0,0,0.75)';
            ctx.fillRect(0, 0, 400, 600);
            
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 48px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('FLAPPY BIRD', 200, 240);
            
            ctx.font = 'bold 28px Arial';
            ctx.fillText('ðŸ‘† Klik / Spasi', 200, 320);
            ctx.fillText('untuk TERBANG!', 200, 360);
            
            ctx.font = 'bold 22px Arial';
            ctx.fillText(`BEST: ${bestScore}`, 200, 430);
        }

        function drawGameOver() {
            ctx.fillStyle = 'rgba(0,0,0,0.85)';
            ctx.fillRect(0, 0, 400, 600);
            
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 48px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('GAME OVER', 200, 240);
            
            ctx.font = 'bold 36px Arial';
            ctx.fillText(`SKOR: ${score}`, 200, 300);
            ctx.fillText(`BEST: ${bestScore}`, 200, 345);
            
            // Medal
            const medals = ['ðŸ¥‰', 'ðŸ¥ˆ', 'ðŸ¥‡'];
            if (score >= 10) {
                const medalIndex = Math.min(Math.floor(score/10)-1, 2);
                ctx.font = '48px Arial';
                ctx.fillText(medals[medalIndex], 200, 410);
            }
            
            ctx.font = 'bold 24px Arial';
            ctx.fillText('F5 Main Lagi', 200, 470);
        }

        function updateMedal() {
            const medals = ['ðŸ¥‰', 'ðŸ¥ˆ', 'ðŸ¥‡'];
            medalEl.textContent = score >= 10 ? medals[Math.min(Math.floor(score/10)-1, 2)] : '';
        }

        function update() {
            if (gameState !== 'play') return;
            
            frame++;
            
            // Speed increases slightly
            speed = 2 + score * 0.005;
            
            // Bird physics
            bird.vy += bird.gravity;
            bird.y += bird.vy;
            bird.rotation = Math.min(Math.max(bird.vy * 0.05, -0.3), 1.2);
            
            // Ground/ceiling collision
            if (bird.y + bird.height > 500 || bird.y < 0) {
                createParticles(bird.x + bird.width/2, bird.y + bird.height/2);
                gameState = 'gameover';
            }
            
            // Pipes
            pipes.forEach((pipe, index) => {
                pipe.x -= speed;
                
                // Score
                if (!pipe.scored && pipe.x + 52 < bird.x) {
                    score++;
                    pipe.scored = true;
                    scoreEl.textContent = score;
                    updateMedal();
                }
                
                // Collision
                if (bird.x < pipe.x + 52 &&
                    bird.x + bird.width > pipe.x &&
                    (bird.y < pipe.topHeight || bird.y + bird.height > pipe.bottomY)) {
                    createParticles(bird.x + bird.width/2, bird.y + bird.height/2);
                    gameState = 'gameover';
                }
                
                if (pipe.x + 52 < 0) {
                    pipes.splice(index, 1);
                }
            });
            
            // Spawn pipes
            pipeTimer++;
            if (pipeTimer > Math.max(80, 100 - score * 0.3)) {
                const gap = 160;
                const topHeight = 80 + Math.random() * 180;
                pipes.push({
                    x: 400, topHeight, bottomY: topHeight + gap, scored: false
                });
                pipeTimer = 0;
            }
            
            updateParticles();
        }

        function gameLoop() {
            // Smooth gradient background
            const gradient = ctx.createLinearGradient(0, 0, 0, 600);
            gradient.addColorStop(0, '#87CEEB');
            gradient.addColorStop(0.4, '#B0E0E6');
            gradient.addColorStop(0.7, '#98D8C8');
            gradient.addColorStop(1, '#E0F2F1');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, 400, 600);
            
            // Draw all elements
            drawSun();
            drawClouds();
            drawGround();
            drawPipes();
            drawBird();
            drawParticles();
            
            update();
            
            if (gameState === 'start') {
                drawStartScreen();
            } else if (gameState === 'gameover') {
                if (score > bestScore) {
                    bestScore = score;
                    localStorage.setItem('flappyBest', bestScore);
                    bestScoreEl.textContent = bestScore;
                }
                drawGameOver();
            } else {
                requestAnimationFrame(gameLoop);
            }
        }

        function handleInput() {
            if (gameState === 'start') {
                gameState = 'play';
                bird.y = 300;
                bird.vy = 0;
                bird.rotation = 0;
                pipes = [];
                pipeTimer = 0;
                score = 0;
                scoreEl.textContent = score;
                medalEl.textContent = '';
                particles = [];
            } else if (gameState === 'play') {
                bird.vy = bird.jump;
                bird.rotation = -0.3;
                bird.flap = 0;
            }
        }

        // Controls
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault();
                handleInput();
            }
        });
        canvas.addEventListener('click', handleInput);
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            handleInput();
        });

        gameLoop();
    </script>
</body>
</html>
